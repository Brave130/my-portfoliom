---
import '../styles/global.css';
import { getCollection } from 'astro:content';

const projects = await getCollection('projects').catch(() => []);
const name = "Brave";
const role = "SYSTEMS ARCHITECT & VOXEL ENGINEER";
---

<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width" />
		<title>{name} // Terminal</title>
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">
		<style>
			/* Typewriter Animation */
			.typewriter {
				overflow: hidden;
				white-space: nowrap;
				border-right: 4px solid #10b981;
				animation: typing 1.5s steps(10, end), blink-caret .75s step-end infinite;
				width: fit-content;
			}
			@keyframes typing { from { width: 0 } to { width: 100% } }
			@keyframes blink-caret { from, to { border-color: transparent } 50% { border-color: #10b981 } }
		</style>
	</head>
	<body class="font-['JetBrains_Mono'] antialiased bg-[#030303] text-zinc-400 overflow-x-hidden">
		
		<div class="fixed inset-0 z-[-1] opacity-20" style="background-image: radial-gradient(#10b981 0.5px, transparent 0.5px); background-size: 24px 24px;"></div>

		<div class="fixed top-8 right-8 z-50">
			<button id="musicToggle" class="flex items-center gap-3 px-3 py-1.5 border border-emerald-500/30 bg-emerald-500/5 hover:bg-emerald-500/10 transition-all rounded text-[10px] text-emerald-500 font-bold tracking-widest pointer-events-auto">
				<span id="musicStatus">AUDIO: OFF</span>
				<div class="flex gap-0.5 items-end h-3">
					<div class="w-0.5 bg-emerald-500 bar" style="height: 100%;"></div>
					<div class="w-0.5 bg-emerald-500 bar" style="height: 60%;"></div>
					<div class="w-0.5 bg-emerald-500 bar" style="height: 80%;"></div>
				</div>
			</button>
			<audio id="bgMusic" loop>
				<source src="/audio/background.mp3" type="audio/mpeg">
			</audio>
		</div>

		<main class="max-w-4xl mx-auto px-8 py-24">
			
			<div class="flex justify-between items-center mb-16 border-b border-emerald-500/20 pb-4">
				<div class="text-emerald-500 font-bold text-sm tracking-[0.3em] uppercase">Status: Operational</div>
				<div class="text-zinc-600 text-[10px]">LOC: 50.1109° N, 8.6821° E</div>
			</div>

			<header class="mb-32">
				<div class="inline-block px-2 py-1 bg-emerald-500/10 border border-emerald-500/20 text-emerald-500 text-[10px] mb-6 tracking-tighter">
					ID: 0x2199-BRAVE
				</div>
				<div class="typewriter">
					<h1 class="text-white text-6xl font-extrabold tracking-tighter mb-4 italic">
						{name}<span class="text-emerald-500 not-italic">.dev</span>
					</h1>
				</div>
				<p class="text-zinc-400 max-w-lg leading-relaxed border-l-2 border-emerald-500/50 pl-6 text-sm mt-6">
					Bypassing limitations in <span class="text-white font-bold">Roblox Luau</span>. 
					Specialized in infinite procedural generation and parallel system architectures.
				</p>
			</header>

			<section>
				<div class="flex items-center gap-4 mb-12">
					<h2 class="text-white font-bold text-xl uppercase tracking-tighter">Selected Archives</h2>
					<div class="h-px flex-1 bg-gradient-to-r from-emerald-500/50 to-transparent"></div>
				</div>

				<div class="grid gap-20">
					{projects && projects.length > 0 ? projects.map(project => (
						<article class="relative group">
							<div class="absolute -inset-4 bg-emerald-500/5 rounded-xl opacity-0 group-hover:opacity-100 transition-all duration-500 border border-emerald-500/10 blur-sm"></div>
							<div class="relative grid md:grid-cols-2 gap-10 items-start">
								<div class="rounded-lg overflow-hidden border border-zinc-800 bg-zinc-950 group-hover:border-emerald-500/50 transition-colors shadow-2xl">
									{project.data.videoUrl ? (
										<video src={project.data.videoUrl} controls muted loop class="w-full aspect-video object-cover grayscale-[0.4] group-hover:grayscale-0 transition-all duration-700"></video>
									) : (
										<div class="aspect-video bg-zinc-900 flex items-center justify-center italic text-zinc-700 uppercase text-xs">No Media Signal</div>
									)}
								</div>
								<div class="flex flex-col justify-center h-full">
									<div class="flex flex-wrap gap-2 mb-4">
										{project.data.tech ? project.data.tech.map(t => (
											<span class="text-[9px] font-bold text-emerald-400/80 uppercase border border-emerald-500/20 px-2 py-0.5 rounded bg-emerald-500/5 tracking-wider">{t}</span>
										)) : null}
									</div>
									<h3 class="text-white text-2xl font-bold mb-3 group-hover:text-emerald-400 transition-colors">{project.data.title || "Untitled Project"}</h3>
									<p class="text-zinc-400 text-sm mb-6 leading-relaxed">{project.data.description || "No description available."}</p>
									{project.data.github ? (
										<div class="mt-auto">
											<a href={project.data.github} target="_blank" class="inline-flex items-center text-emerald-500 text-[10px] font-bold hover:gap-4 transition-all tracking-[0.2em] border border-emerald-500/30 px-4 py-2 bg-emerald-500/5 rounded hover:bg-emerald-500/10">
												INITIATE PROTOCOL <span class="ml-2">→</span>
											</a>
										</div>
									) : (
										<div class="mt-auto text-[10px] text-zinc-600 font-bold tracking-[0.2em] italic">[ STATUS: UNDER DEVELOPMENT ]</div>
									)}
								</div>
							</div>
						</article>
					)) : <div class="text-zinc-600 italic border border-zinc-800 p-8 text-center rounded-lg">No data found.</div>}
				</div>
			</section>

			<footer class="mt-40 pt-12 border-t border-zinc-900 flex flex-col items-center">
				<div class="text-[10px] text-zinc-600 tracking-[0.5em] uppercase mb-6 text-center">End of Transmission</div>
				<div class="w-1.5 h-1.5 bg-emerald-500 rounded-full animate-ping"></div>
			</footer>
		</main>

		<script is:inline>
			const btn = document.getElementById('musicToggle');
			const music = document.getElementById('bgMusic');
			const status = document.getElementById('musicStatus');
			const bars = document.querySelectorAll('.bar');

			btn.addEventListener('click', () => {
				if (music.paused) {
					music.play().then(() => {
						status.innerText = 'AUDIO: ON';
						bars.forEach(bar => bar.classList.add('animate-bounce'));
					}).catch(err => console.error("Error playing audio:", err));
				} else {
					music.pause();
					status.innerText = 'AUDIO: OFF';
					bars.forEach(bar => bar.classList.remove('animate-bounce'));
				}
			});
		</script>
	</body>
</html>